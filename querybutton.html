<script>
  const scriptURL = 'https://script.google.com/macros/s/AKfycbxNAjOjf-Ds0UA_sqDRhdd25_Zx4UVJylOC9KfO6NqZJUnk4qNbxonkC1qDKftsjDvi/exec';

  // Try to get top page URL, fallback if blocked
  function getSafeURL() {
    try {
      return window.top.location.href;
    } catch (e) {
      return 'Blocked by browser';
    }
  }

  document.getElementById('reportBtn').addEventListener('click', () => {
    const pageURL = encodeURIComponent(getSafeURL());

    fetch(`${scriptURL}?url=${pageURL}&message=User reported broken link`)
      .then(response => {
        if (response.ok) {
          alert('Thank you for letting us know. We will rectify it.\n\nKindly join our Telegram channel: https://t.me/tamildoods');
        } else {
          alert('Oops, something went wrong. Please try again later.');
        }
      })
      .catch(() => {
        alert('Oops, something went wrong. Please try again later.');
      });
  });
</script>
